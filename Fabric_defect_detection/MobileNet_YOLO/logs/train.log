2020-11-27 15:57:08,424 - train.py[line:438] - INFO: start train YOLOv3, train params:{'data_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_proto\\ShuffleNetV2_YOLOv3\\v1.1\\dataset\\train', 'val_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_proto\\MobileNet_YOLO\\Fast_YOLO\\v1.1\\valid', 'train_list': 'train.txt', 'eval_list': 'valid.txt', 'use_filter': False, 'class_dim': 1, 'label_dict': {'defect': 0}, 'num_dict': {0: 'defect'}, 'image_count': 5000, 'continue_train': True, 'pretrained': False, 'pretrained_model_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_proto\\MobileNet_YOLO\\Fast_YOLO\\v1.2\\pretrained_model', 'save_model_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_proto\\MobileNet_YOLO\\Fast_YOLO\\v1.2\\saved_model', 'model_prefix': 'yolo-v3', 'freeze_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_proto\\MobileNet_YOLO\\Fast_YOLO\\v1.2\\freeze_model', 'use_tiny': False, 'max_box_num': 5, 'num_epochs': 101, 'train_batch_size': 16, 'use_gpu': True, 'yolo_cfg': {'input_size': [3, 352, 352], 'anchors': [351, 16, 15, 188, 16, 351], 'anchor_mask': [[0, 1, 2]]}, 'yolo_tiny_cfg': {'input_size': [3, 352, 352], 'anchors': [96, 15, 157, 15, 240, 16, 303, 17, 351, 16, 351, 26], 'anchor_mask': [[3, 4, 5], [0, 1, 2]]}, 'ignore_thresh': 0.7, 'mean_rgb': [127.5, 127.5, 127.5], 'mode': 'train', 'multi_data_reader_count': 4, 'apply_distort': True, 'nms_top_k': 6, 'nms_pos_k': 6, 'valid_thresh': 0.005, 'nms_thresh': 0.1, 'image_distort_strategy': {'expand_prob': 0.5, 'expand_max_ratio': 4, 'hue_prob': 0.5, 'hue_delta': 18, 'contrast_prob': 0.5, 'contrast_delta': 0.5, 'saturation_prob': 0.5, 'saturation_delta': 0.5, 'brightness_prob': 0.5, 'brightness_delta': 0.5}, 'sgd_strategy': {'learning_rate': 0.002, 'lr_epochs': [10, 45, 80, 110, 135, 160, 180], 'lr_decay': [1, 0.5, 0.25, 0.1, 0.025, 0.004, 0.001, 0.0005]}, 'early_stop': {'sample_frequency': 50, 'rise_limit': 10, 'min_loss': 5e-08, 'min_curr_map': 0.84}}
2020-11-27 15:57:08,427 - train.py[line:440] - INFO: create place, use gpu:True
2020-11-27 15:57:08,427 - train.py[line:443] - INFO: build network and program
2020-11-27 15:57:10,155 - train.py[line:457] - INFO: build executor and init params
2020-11-27 15:57:14,158 - train.py[line:418] - INFO: load param from retrain model
2020-11-27 15:57:14,683 - train.py[line:477] - INFO: current pass: 0, start read image
2020-11-27 16:09:07,421 - train.py[line:492] - INFO: pass 0, trainbatch 200, loss 6.08405065536499, time 0.27 sec
2020-11-27 16:15:11,940 - train.py[line:494] - INFO: pass 0 train result, current pass mean loss: 7.145500667559834
2020-11-27 16:16:22,255 - train.py[line:500] - INFO: 0 epoch current pass map is 0.9229022860527039, accum_map is 0.9229022860527039
2020-11-27 16:16:22,256 - train.py[line:506] - INFO: model save 0 epcho train result, current best pass MAP 0.9229022860527039
2020-11-27 16:16:24,669 - train.py[line:512] - INFO: best pass 0 current best pass MAP is 0.9229022860527039
2020-11-27 16:16:24,669 - train.py[line:477] - INFO: current pass: 1, start read image
2020-11-27 16:18:14,060 - train.py[line:492] - INFO: pass 1, trainbatch 200, loss 6.016266822814941, time 0.26 sec
2020-11-27 16:19:14,948 - train.py[line:494] - INFO: pass 1 train result, current pass mean loss: 5.984632001517299
2020-11-27 16:19:14,948 - train.py[line:477] - INFO: current pass: 2, start read image
2020-11-27 16:21:03,303 - train.py[line:492] - INFO: pass 2, trainbatch 200, loss 5.421288967132568, time 0.26 sec
2020-11-27 16:22:03,967 - train.py[line:494] - INFO: pass 2 train result, current pass mean loss: 5.6151879557405415
2020-11-27 16:23:14,622 - train.py[line:500] - INFO: 2 epoch current pass map is 0.9136424660682678, accum_map is 0.9160047769546509
2020-11-27 16:23:14,622 - train.py[line:512] - INFO: best pass 0 current best pass MAP is 0.9229022860527039
2020-11-27 16:23:14,623 - train.py[line:477] - INFO: current pass: 3, start read image
2020-11-27 16:25:04,686 - train.py[line:492] - INFO: pass 3, trainbatch 200, loss 6.439384460449219, time 0.26 sec
2020-11-27 16:26:06,354 - train.py[line:494] - INFO: pass 3 train result, current pass mean loss: 5.386003592524665
2020-11-27 16:26:06,356 - train.py[line:477] - INFO: current pass: 4, start read image
2020-11-27 16:27:55,601 - train.py[line:492] - INFO: pass 4, trainbatch 200, loss 4.217554569244385, time 0.27 sec
2020-11-27 16:28:57,020 - train.py[line:494] - INFO: pass 4 train result, current pass mean loss: 5.2616707402677205
2020-11-27 16:30:06,605 - train.py[line:500] - INFO: 4 epoch current pass map is 0.9388309717178345, accum_map is 0.9236701130867004
2020-11-27 16:30:06,607 - train.py[line:506] - INFO: model save 4 epcho train result, current best pass MAP 0.9388309717178345
2020-11-27 16:30:08,920 - train.py[line:512] - INFO: best pass 4 current best pass MAP is 0.9388309717178345
2020-11-27 16:30:08,922 - train.py[line:477] - INFO: current pass: 5, start read image
2020-11-27 16:31:58,313 - train.py[line:492] - INFO: pass 5, trainbatch 200, loss 4.566411018371582, time 0.27 sec
2020-11-27 16:32:59,522 - train.py[line:494] - INFO: pass 5 train result, current pass mean loss: 5.071163198818414
2020-11-27 16:32:59,523 - train.py[line:477] - INFO: current pass: 6, start read image
2020-11-27 16:34:49,995 - train.py[line:492] - INFO: pass 6, trainbatch 200, loss 3.8845367431640625, time 0.26 sec
2020-11-27 16:35:51,118 - train.py[line:494] - INFO: pass 6 train result, current pass mean loss: 5.033541667956514
2020-11-27 16:39:43,980 - train.py[line:500] - INFO: 6 epoch current pass map is 0.9587180018424988, accum_map is 0.9325464367866516
2020-11-27 16:39:43,980 - train.py[line:506] - INFO: model save 6 epcho train result, current best pass MAP 0.9587180018424988
2020-11-27 16:39:46,467 - train.py[line:512] - INFO: best pass 6 current best pass MAP is 0.9587180018424988
2020-11-27 16:39:46,468 - train.py[line:477] - INFO: current pass: 7, start read image
2020-11-27 16:41:34,015 - train.py[line:492] - INFO: pass 7, trainbatch 200, loss 3.5966129302978516, time 0.26 sec
2020-11-27 16:42:35,022 - train.py[line:494] - INFO: pass 7 train result, current pass mean loss: 4.891163841223183
2020-11-27 16:42:35,023 - train.py[line:477] - INFO: current pass: 8, start read image
2020-11-27 16:44:25,704 - train.py[line:492] - INFO: pass 8, trainbatch 200, loss 4.853396415710449, time 0.26 sec
2020-11-27 16:45:27,038 - train.py[line:494] - INFO: pass 8 train result, current pass mean loss: 4.7896050134786785
2020-11-27 16:46:37,322 - train.py[line:500] - INFO: 8 epoch current pass map is 0.9561125636100769, accum_map is 0.9377033114433289
2020-11-27 16:46:37,323 - train.py[line:512] - INFO: best pass 6 current best pass MAP is 0.9587180018424988
2020-11-27 16:46:37,331 - train.py[line:477] - INFO: current pass: 9, start read image
