2020-12-29 00:50:19,112 - train.py[line:438] - INFO: start train YOLOv3, train params:{'data_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_dev\\v1.1.0\\dataset\\train', 'val_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_dev\\v1.1.0\\dataset\\valid', 'train_list': 'train.txt', 'eval_list': 'valid.txt', 'use_filter': False, 'class_dim': 2, 'label_dict': {'defect': 0, 'striation': 1}, 'num_dict': {0: 'defect', 1: 'striation'}, 'image_count': 1420, 'continue_train': True, 'pretrained': False, 'pretrained_model_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_dev\\v1.1.0\\pretrained_model', 'save_model_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_dev\\v1.1.0\\saved_model', 'model_prefix': 'yolo-v3', 'freeze_dir': 'E:\\Projects\\Fabric_Defect_Detection\\model_dev\\v1.1.0\\freeze_model', 'use_tiny': False, 'max_box_num': 10, 'num_epochs': 100, 'train_batch_size': 16, 'use_gpu': True, 'yolo_cfg': {'input_size': [3, 352, 352], 'anchors': [483, 25, 707, 30, 30, 537], 'anchor_mask': [[0, 1, 2]]}, 'yolo_tiny_cfg': {'input_size': [3, 352, 352], 'anchors': [96, 15, 157, 15, 240, 16, 303, 17, 351, 16, 351, 26], 'anchor_mask': [[3, 4, 5], [0, 1, 2]]}, 'ignore_thresh': 0.7, 'mean_rgb': [127.5, 127.5, 127.5], 'mode': 'train', 'multi_data_reader_count': 4, 'apply_distort': True, 'nms_top_k': 10, 'nms_pos_k': 10, 'valid_thresh': 0.005, 'nms_thresh': 0.1, 'image_distort_strategy': {'expand_prob': 0.5, 'expand_max_ratio': 1.25, 'hue_prob': 0.5, 'hue_delta': 18, 'contrast_prob': 0.5, 'contrast_delta': 0.3, 'saturation_prob': 0.5, 'saturation_delta': 0.5, 'brightness_prob': 0.5, 'brightness_delta': 0.6}, 'sgd_strategy': {'learning_rate': 0.002, 'lr_epochs': [10, 45, 80, 110, 135, 160, 180], 'lr_decay': [1, 0.5, 0.25, 0.1, 0.025, 0.004, 0.001, 0.0005]}, 'early_stop': {'sample_frequency': 50, 'rise_limit': 10, 'min_loss': 5e-08, 'min_curr_map': 0.84}}
2020-12-29 00:50:19,112 - train.py[line:440] - INFO: create place, use gpu:True
2020-12-29 00:50:19,112 - train.py[line:443] - INFO: build network and program
2020-12-29 00:50:20,565 - train.py[line:457] - INFO: build executor and init params
2020-12-29 00:50:23,178 - train.py[line:418] - INFO: load param from retrain model
2020-12-29 00:50:23,678 - train.py[line:477] - INFO: current pass: 0, start read image
2020-12-29 00:51:36,749 - train.py[line:494] - INFO: pass 0 train result, current pass mean loss: 8.555123982804545
2020-12-29 00:51:55,069 - train.py[line:500] - INFO: 0 epoch current pass map is 0.9521989822387695, accum_map is 0.9521989822387695
2020-12-29 00:51:55,069 - train.py[line:506] - INFO: model save 0 epcho train result, current best pass MAP 0.9521989822387695
2020-12-29 00:51:57,335 - train.py[line:512] - INFO: best pass 0 current best pass MAP is 0.9521989822387695
2020-12-29 00:51:57,335 - train.py[line:477] - INFO: current pass: 1, start read image
2020-12-29 00:53:10,397 - train.py[line:494] - INFO: pass 1 train result, current pass mean loss: 8.458073155263836
2020-12-29 00:53:10,397 - train.py[line:477] - INFO: current pass: 2, start read image
2020-12-29 00:54:22,354 - train.py[line:494] - INFO: pass 2 train result, current pass mean loss: 8.373941357216138
2020-12-29 00:54:40,578 - train.py[line:500] - INFO: 2 epoch current pass map is 0.9548969268798828, accum_map is 0.9527894258499146
2020-12-29 00:54:40,578 - train.py[line:506] - INFO: model save 2 epcho train result, current best pass MAP 0.9548969268798828
2020-12-29 00:54:42,636 - train.py[line:512] - INFO: best pass 2 current best pass MAP is 0.9548969268798828
2020-12-29 00:54:42,636 - train.py[line:477] - INFO: current pass: 3, start read image
2020-12-29 00:55:54,455 - train.py[line:494] - INFO: pass 3 train result, current pass mean loss: 8.436592916424354
2020-12-29 00:55:54,455 - train.py[line:477] - INFO: current pass: 4, start read image
2020-12-29 00:57:07,017 - train.py[line:494] - INFO: pass 4 train result, current pass mean loss: 8.23633232545317
2020-12-29 00:57:25,341 - train.py[line:500] - INFO: 4 epoch current pass map is 0.9651924967765808, accum_map is 0.9569153785705566
2020-12-29 00:57:25,341 - train.py[line:506] - INFO: model save 4 epcho train result, current best pass MAP 0.9651924967765808
2020-12-29 00:57:27,685 - train.py[line:512] - INFO: best pass 4 current best pass MAP is 0.9651924967765808
2020-12-29 00:57:27,685 - train.py[line:477] - INFO: current pass: 5, start read image
2020-12-29 00:58:40,157 - train.py[line:494] - INFO: pass 5 train result, current pass mean loss: 8.284299025374851
2020-12-29 00:58:40,157 - train.py[line:477] - INFO: current pass: 6, start read image
2020-12-29 00:59:52,821 - train.py[line:494] - INFO: pass 6 train result, current pass mean loss: 8.143628232934502
2020-12-29 01:00:11,200 - train.py[line:500] - INFO: 6 epoch current pass map is 0.9650607705116272, accum_map is 0.9589449763298035
2020-12-29 01:00:11,200 - train.py[line:512] - INFO: best pass 4 current best pass MAP is 0.9651924967765808
2020-12-29 01:00:11,200 - train.py[line:477] - INFO: current pass: 7, start read image
2020-12-29 01:01:23,491 - train.py[line:494] - INFO: pass 7 train result, current pass mean loss: 8.158907167027506
2020-12-29 01:01:23,491 - train.py[line:477] - INFO: current pass: 8, start read image
2020-12-29 01:02:35,830 - train.py[line:494] - INFO: pass 8 train result, current pass mean loss: 8.044242215960214
2020-12-29 01:02:54,208 - train.py[line:500] - INFO: 8 epoch current pass map is 0.9727869033813477, accum_map is 0.9618901014328003
2020-12-29 01:02:54,208 - train.py[line:506] - INFO: model save 8 epcho train result, current best pass MAP 0.9727869033813477
2020-12-29 01:02:56,291 - train.py[line:512] - INFO: best pass 8 current best pass MAP is 0.9727869033813477
2020-12-29 01:02:56,291 - train.py[line:477] - INFO: current pass: 9, start read image
2020-12-29 01:04:08,468 - train.py[line:494] - INFO: pass 9 train result, current pass mean loss: 7.963372214456623
2020-12-29 01:04:08,468 - train.py[line:477] - INFO: current pass: 10, start read image
2020-12-29 01:05:20,880 - train.py[line:494] - INFO: pass 10 train result, current pass mean loss: 7.958748817443848
2020-12-29 01:05:39,241 - train.py[line:500] - INFO: 10 epoch current pass map is 0.9712669849395752, accum_map is 0.9623247385025024
2020-12-29 01:05:39,241 - train.py[line:512] - INFO: best pass 8 current best pass MAP is 0.9727869033813477
2020-12-29 01:05:39,241 - train.py[line:477] - INFO: current pass: 11, start read image
2020-12-29 01:06:51,253 - train.py[line:494] - INFO: pass 11 train result, current pass mean loss: 7.952195306842246
2020-12-29 01:06:51,253 - train.py[line:477] - INFO: current pass: 12, start read image
2020-12-29 01:08:03,210 - train.py[line:494] - INFO: pass 12 train result, current pass mean loss: 7.846670927626364
2020-12-29 01:08:48,581 - train.py[line:500] - INFO: 12 epoch current pass map is 0.9595268964767456, accum_map is 0.9615188837051392
2020-12-29 01:08:48,581 - train.py[line:512] - INFO: best pass 8 current best pass MAP is 0.9727869033813477
2020-12-29 01:08:48,581 - train.py[line:477] - INFO: current pass: 13, start read image
